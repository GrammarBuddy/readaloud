<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReadRight</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #e2e8f0; /* bg-slate-200 */
        }
        .container {
            max-width: 600px;
            margin: 4rem auto;
            padding: 2rem;
            background-color: #ffffff;
            border-radius: 1.5rem; /* rounded-3xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-xl */
        }
        .button-group button {
            transition: all 0.2s ease;
        }
        .button-group button.active {
            box-shadow: 0 0 0 3px #6ee7b7; /* ring-4 ring-green-300 */
        }
        .scroll-container {
            height: 150px; /* Increased height for better visibility */
            overflow: hidden;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 1.5rem; /* text-2xl */
        }
        .reading-text {
            white-space: nowrap;
            display: inline-block;
            transform: translateY(100%);
        }
        .progress-bar {
            height: 10px;
            background-color: #34d399; /* bg-emerald-400 */
            width: 0%;
            border-radius: 9999px; /* rounded-full */
        }
        @keyframes scroll {
            from {
                transform: translateY(100%);
            }
            to {
                transform: translateY(-100%);
            }
        }
        #countdown {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4rem; /* text-6xl */
            font-weight: bold;
            color: #10b981; /* text-emerald-600 */
            z-index: 10;
        }
        .button-style {
            padding: 0.75rem 2rem;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 9999px;
            color: white;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
            border: none;
            outline: none;
        }
        .button-style:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .orange-btn {
            background: linear-gradient(145deg, #f97316, #ea580c);
        }
        .red-btn {
            background: linear-gradient(145deg, #ef4444, #dc2626);
        }
    </style>
</head>
<body class="bg-slate-200 antialiased">
    <div class="container">
        <header class="text-center mb-6">
            <h1 class="text-4xl font-extrabold text-slate-800 flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-emerald-500 mr-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20V5H6.5A2.5 2.5 0 0 0 4 7.5V19.5z" />
                    <path d="M12 2v6" />
                </svg>
                ReadRight
            </h1>
            <p class="text-lg text-slate-600 mt-2">Improve your reading speed and comprehension.</p>
        </header>

        <section class="flex justify-center space-x-4 mb-8 button-group">
            <button id="easy-btn" class="px-6 py-2 rounded-full border border-emerald-500 text-emerald-500 font-semibold hover:bg-emerald-50 hover:text-emerald-600 focus:outline-none focus:ring-4 focus:ring-emerald-300">Easy</button>
            <button id="medium-btn" class="px-6 py-2 rounded-full border border-emerald-500 text-emerald-500 font-semibold hover:bg-emerald-50 hover:text-emerald-600 focus:outline-none focus:ring-4 focus:ring-emerald-300">Medium</button>
            <button id="hard-btn" class="px-6 py-2 rounded-full border border-emerald-500 text-emerald-500 font-semibold hover:bg-emerald-50 hover:text-emerald-600 focus:outline-none focus:ring-4 focus:ring-emerald-300">Hard</button>
        </section>

        <main class="bg-slate-50 rounded-2xl p-8 mb-8 shadow-inner">
            <div id="scroll-container" class="scroll-container">
                <span id="reading-text" class="reading-text text-slate-700">Select a difficulty to begin!</span>
                <div id="countdown" class="hidden">3</div>
            </div>
            <div class="mt-8">
                <div class="w-full h-2 rounded-full bg-slate-300">
                    <div id="progress-bar" class="progress-bar"></div>
                </div>
            </div>
        </main>

        <section class="text-center mb-8">
            <div class="flex items-center justify-center mb-4">
                <label for="speed-slider" class="mr-4 text-slate-600">Speed:</label>
                <input type="range" id="speed-slider" min="100" max="600" value="300" step="10" class="w-2/3">
                <span id="speed-value" class="ml-4 text-slate-800 font-semibold">300 WPM</span>
            </div>
        </section>

        <section class="flex justify-center space-x-6">
            <button id="start-btn" class="button-style orange-btn">Start</button>
            <button id="pause-btn" class="button-style orange-btn hidden">Pause</button>
            <button id="resume-btn" class="button-style orange-btn hidden">Resume</button>
            <button id="reset-btn" class="button-style red-btn">Reset</button>
        </section>
    </div>

    <script>
        // API key should be left as empty string. The Canvas environment will handle it.
        const apiKey = "";
        const API_URL_TEXT_GEN = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

        let currentPassage = "";
        let wordCount = 0;
        let animationDuration = 0;
        let isPaused = false;

        const passages = {
            easy: [
                "The quick brown fox jumps over the lazy dog.",
                "A tiny boat sailed on the big blue sea.",
                "The sun shines brightly in the sky today.",
                "A soft wind blows through the green trees.",
                "The fluffy cat slept soundly on the chair."
            ],
            medium: [
                "Beneath the waning afternoon light, the old library stood like a sentinel, its towering shelves filled with the whispers of countless stories. Dust motes danced in the sunbeams, illuminating the timeless pages of forgotten lore.",
                "A lone traveler ventured into the dense, misty forest, guided only by the faint light of a silver moon. Every rustle of leaves and snap of twigs sent a shiver down his spine, as if the ancient woods held secrets he was not meant to discover.",
                "The bustling marketplace was a symphony of sounds and smells, a vibrant tapestry of human activity. Merchants shouted their wares, children laughed, and the aroma of exotic spices mingled with the sweet scent of fresh-baked bread.",
                "High above the clouds, a majestic eagle soared on silent wings, surveying the world below with a keen and unblinking eye. It circled in perfect, effortless spirals, a testament to the raw, untamed freedom of the open sky.",
                "The clock tower chimed the hour, its deep, resonant tones echoing through the quiet streets. A gentle rain began to fall, washing the cobblestones clean and casting a soft, reflective sheen upon the sleeping city.",
            ],
            hard: [
                "The pervasive digitalization of modern society has fundamentally altered the landscape of human communication, necessitating a re-evaluation of our cognitive paradigms and social constructs. The confluence of ubiquitous connectivity and sophisticated algorithms presents both unprecedented opportunities for global collaboration and formidable challenges to individual privacy and intellectual autonomy.",
                "In a nuanced analysis of postmodern literary theory, one must contend with the deconstruction of grand narratives and the inherent skepticism towards objective truth. This intellectual movement posits that meaning is not fixed but is instead a fluid construct, shaped by linguistic and cultural frameworks, thereby inviting a multiplicity of interpretations and a questioning of canonical authority.",
                "The intricate symbiotic relationship between mycorrhizal fungi and plant roots represents a cornerstone of terrestrial ecosystem function, facilitating the efficient exchange of essential nutrients and water. This subterranean network, often unseen and undervalued, is critical for plant survival in nutrient-poor environments and plays a pivotal role in maintaining biodiversity.",
                "Quantum entanglement, a phenomenon in which the quantum states of two or more particles are linked in such a way that they cannot be described independently of each other, defies classical intuition and challenges our conventional understanding of causality. Its implications for cryptography and computing are profound, promising a new era of secure communication and computational power.",
                "The architectural evolution of the Roman aqueduct system exemplifies a masterful synthesis of engineering prowess and urban planning. By leveraging a sophisticated understanding of gravity and hydraulics, these structures not only supplied a burgeoning populace with a reliable source of fresh water but also served as powerful symbols of imperial ambition and civilizational advancement."
            ]
        };

        const easyBtn = document.getElementById('easy-btn');
        const mediumBtn = document.getElementById('medium-btn');
        const hardBtn = document.getElementById('hard-btn');
        const readingText = document.getElementById('reading-text');
        const speedSlider = document.getElementById('speed-slider');
        const speedValueDisplay = document.getElementById('speed-value');
        const startBtn = document.getElementById('start-btn');
        const pauseBtn = document.getElementById('pause-btn');
        const resumeBtn = document.getElementById('resume-btn');
        const resetBtn = document.getElementById('reset-btn');
        const progressBar = document.getElementById('progress-bar');
        const countdownElement = document.getElementById('countdown');

        let intervalId;

        easyBtn.addEventListener('click', () => {
            selectLevel('easy');
        });
        mediumBtn.addEventListener('click', () => {
            selectLevel('medium');
        });
        hardBtn.addEventListener('click', () => {
            selectLevel('hard');
        });

        startBtn.addEventListener('click', startCountdown);
        pauseBtn.addEventListener('click', pauseApp);
        resumeBtn.addEventListener('click', resumeApp);
        resetBtn.addEventListener('click', resetApp);
        
        speedSlider.addEventListener('input', (e) => {
            setSpeed(e.target.value);
        });

        function selectLevel(level) {
            const selectedPassage = passages[level][Math.floor(Math.random() * passages[level].length)];
            currentPassage = selectedPassage;
            wordCount = currentPassage.split(' ').length;
            readingText.textContent = currentPassage;
            readingText.style.display = 'inline-block';
            resetApp(); // Reset the UI to its initial state
            setSpeed(speedSlider.value); // Set the speed for the new passage
            
            // Highlight the selected difficulty button
            document.querySelectorAll('.button-group button').forEach(btn => {
                btn.classList.remove('active', 'bg-emerald-50', 'text-emerald-600', 'ring-4', 'ring-emerald-300');
                btn.classList.add('hover:bg-emerald-50', 'hover:text-emerald-600');
            });
            document.getElementById(`${level}-btn`).classList.add('active', 'bg-emerald-50', 'text-emerald-600');
            document.getElementById(`${level}-btn`).classList.remove('hover:bg-emerald-50', 'hover:text-emerald-600');
        }

        function setSpeed(speed) {
            speedValueDisplay.textContent = `${speed} WPM`;
            animationDuration = (wordCount / speed) * 60;
        }

        function startCountdown() {
            if (!currentPassage) return;
            let count = 3;
            countdownElement.textContent = count;
            countdownElement.classList.remove('hidden');
            startBtn.classList.add('hidden');
            pauseBtn.classList.add('hidden');
            resumeBtn.classList.add('hidden');
            
            intervalId = setInterval(() => {
                count--;
                if (count > 0) {
                    countdownElement.textContent = count;
                } else {
                    clearInterval(intervalId);
                    countdownElement.classList.add('hidden');
                    startScroll();
                }
            }, 1000);
        }

        function startScroll() {
            // Immediately start the animation
            readingText.style.animationName = 'scroll';
            readingText.style.animationTimingFunction = 'linear';
            readingText.style.animationFillMode = 'forwards';
            readingText.style.animationPlayState = 'running';
            readingText.style.animationDuration = `${animationDuration}s`;

            // Start progress bar animation
            progressBar.style.transition = `width ${animationDuration}s linear`;
            progressBar.style.width = '100%';
            
            // Show pause and reset buttons, hide start button
            startBtn.style.display = 'none';
            pauseBtn.style.display = 'block';
            resumeBtn.style.display = 'none';
        }

        function pauseApp() {
            if (isPaused) return;
            isPaused = true;
            readingText.style.animationPlayState = 'paused';
            progressBar.style.transition = 'none';
            
            const currentWidth = progressBar.offsetWidth;
            const containerWidth = progressBar.parentElement.offsetWidth;
            const remainingDuration = animationDuration * (1 - currentWidth / containerWidth);

            progressBar.style.transition = `width ${remainingDuration}s linear`;
            
            pauseBtn.style.display = 'none';
            resumeBtn.style.display = 'block';
        }

        function resumeApp() {
            if (!isPaused) return;
            isPaused = false;
            readingText.style.animationPlayState = 'running';
            
            // Resume the progress bar animation
            const currentWidth = progressBar.offsetWidth;
            const containerWidth = progressBar.parentElement.offsetWidth;
            const remainingDuration = animationDuration * (1 - currentWidth / containerWidth);
            
            progressBar.style.transition = `width ${remainingDuration}s linear`;
            progressBar.style.width = '100%';

            pauseBtn.style.display = 'block';
            resumeBtn.style.display = 'none';
        }

        function resetApp() {
            clearInterval(intervalId);
            isPaused = false;
            countdownElement.classList.add('hidden');
            
            readingText.style.animation = 'none';
            readingText.style.transform = 'translateY(100%)';
            progressBar.style.transition = 'none';
            progressBar.style.width = '0%';
            
            // Hide pause/resume buttons and show start button
            startBtn.style.display = 'block';
            pauseBtn.style.display = 'none';
            resumeBtn.style.display = 'none';
        }
    </script>
</body>
</html>
