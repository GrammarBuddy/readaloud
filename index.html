<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1" />
Â  <title>ðŸ“– ReadRight</title>
Â  <style>
Â  Â  :root{
Â  Â  Â  --bg:#0f172a;Â  Â  Â  Â /* slate-900 */
Â  Â  Â  --panel:#111827;Â  Â  Â  Â /* gray-900 */
Â  Â  Â  --muted:#94a3b8;Â  Â  Â  Â /* slate-400 */
Â  Â  Â  --text:#e5e7eb;Â  Â  Â  /* gray-200 */
Â  Â  Â  --accent:#22c55e;Â  Â  Â  /* green-500 */
Â  Â  Â  --accent-2:#3b82f6;Â  Â /* blue-500 */
Â  Â  Â  --danger:#ef4444;Â  Â  Â  /* red-500 */
Â  Â  Â  --warning:#f59e0b;Â  Â  Â /* amber-500 */
Â  Â  Â  --btn:#1f2937;Â  Â  Â  Â  /* gray-800 */
Â  Â  Â  --btn-hover:#374151;Â  Â /* gray-700 */
Â  Â  Â  --radius:16px;
Â  Â  }
Â  Â  * { box-sizing:border-box }
Â  Â  body{
Â  Â  Â  margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
Â  Â  Â  background: linear-gradient(180deg, var(--bg), #0b1226 35%);
Â  Â  Â  color:var(--text);
Â  Â  Â  min-height:100dvh; display:flex; align-items:center; justify-content:center; padding:24px;
Â  Â  }
Â  Â  .app{ width:min(900px, 96vw); }
Â  Â  .card{
Â  Â  Â  background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
Â  Â  Â  border:1px solid rgba(255,255,255,0.08);
Â  Â  Â  border-radius:calc(var(--radius) + 4px);
Â  Â  Â  box-shadow:0 10px 30px rgba(0,0,0,0.35);
Â  Â  Â  padding:20px; backdrop-filter: blur(6px);
Â  Â  }
Â  Â  h1{margin:0 0 14px; font-size: clamp(22px, 3.5vw, 32px); letter-spacing:0.3px}
Â  Â  .sub{color:var(--muted); margin-bottom:18px}

Â  Â  /* Top links */
.top-nav {
Â  position: absolute;
Â  top: 10px;
Â  /* Use left and transform to center horizontally */
Â  left: 50%;
Â  transform: translateX(-50%);
Â Â 
Â  display: flex;
Â  justify-content: center; /* This centers the links within the flex container */
Â  gap: 12px;
}
Â  Â  .top-nav a {
Â  Â  Â  font-size: 14px;
Â  Â  Â  color: var(--danger);
Â  Â  Â  text-decoration: none;
Â  Â  Â  font-weight: 600;
Â  Â  Â  transition: opacity .2s ease;
Â  Â  }
Â  Â  .top-nav a:hover {
Â  Â  Â  opacity: 0.8;
Â  Â  }

Â  Â  /* Top controls */
Â  Â  .row{display:flex; flex-wrap:wrap; gap:12px; align-items:center}
Â  Â  .levels{display:flex; gap:10px; flex-wrap:wrap}
Â  Â  .btn{
Â  Â  Â  cursor:pointer; user-select:none; border:none; color:var(--text);
Â  Â  Â  background:var(--btn); padding:10px 16px; border-radius:999px; font-weight:600;
Â  Â  Â  transition: transform .06s ease, background .15s ease, box-shadow .15s ease;
Â  Â  Â  box-shadow: 0 4px 12px rgba(0,0,0,0.25) inset, 0 2px 8px rgba(0,0,0,0.25);
Â  Â  }
Â  Â  .btn:hover{ background:var(--btn-hover); transform: translateY(-1px)}
Â  Â  .btn:active{ transform: translateY(0)}
Â  Â  .btn.primary{ background:linear-gradient(90deg, var(--accent), var(--accent-2)); }
Â  Â  .btn.primary:hover{ filter:brightness(1.05) }
Â  Â  .btn-outline{ background:transparent; border:1px solid rgba(255,255,255,0.18) }
Â  Â  .btn-danger{ background:var(--danger) }
Â  Â  .btn-warning{ background:var(--warning); color:#111 }
Â  Â  .btn.level{ position:relative; overflow:hidden }
Â  Â  .btn.level.active{ outline:2px solid var(--accent); box-shadow:0 0 0 4px rgba(34,197,94,0.15) }

Â  Â  /* Slider */
Â  Â  .slider-wrap{ display:flex; align-items:center; gap:12px; margin:6px 0 12px }
Â  Â  input[type="range"]{ width:70% }
Â  Â  .badge{ padding:6px 10px; border-radius:999px; background:rgba(255,255,255,0.1); color:var(--text); font-weight:700 }

Â  Â  /* Viewport (scroll box) */
Â  Â  .viewport{
Â  Â  Â  position:relative; overflow:hidden; height:360px; border-radius:var(--radius);
Â  Â  Â  background: linear-gradient(180deg, rgba(15,23,42,0.6), rgba(15,23,42,0.9));
Â  Â  Â  border:1px solid rgba(255,255,255,0.12);
Â  Â  Â  padding: 16px 18px; margin: 14px 0 12px;
Â  Â  }
Â  Â  .scroller{ position:absolute; left:0; right:0; transform: translateY(0); will-change: transform; }
Â  Â  .passage{ white-space:pre-wrap; line-height:1.7; font-size: clamp(15px, 1.3vw, 18px); letter-spacing:0.2px }
Â  Â  .placeholder{ position:absolute; inset:0; display:grid; place-items:center; text-align:center; color:var(--muted); padding:16px }
Â  Â  .controls{ display:flex; gap:10px; justify-content:flex-end; margin-top:10px }

Â  Â  .hidden{ display:none !important }
Â  Â  .sr{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0 }
Â  </style>
</head>
<body>

<div class="top-nav">
Â  Â  <a href="https://grammarbuddy.github.io">Home</a>Â  |Â Â 
Â  Â  <a href="https://sites.google.com/view/gbspellbee/home">Spelling_Bee</a>Â  |Â Â 
Â  Â  <a href="https://sites.google.com/view/titatov3/home">TaTiTo_Code</a>
Â  </div>

Â Â 
Â  <main class="app">
Â  Â  <div class="card">
Â  Â  Â  <h1>ðŸ“– ReadRight</h1>
Â  Â  Â  <div class="row" style="justify-content:space-between">
Â  Â  Â  Â  <div class="levels" role="group" aria-label="Choose difficulty">
Â  Â  Â  Â  Â  <button class="btn level" data-level="easy">Easy</button>
Â  Â  Â  Â  Â  <button class="btn level" data-level="medium">Medium</button>
Â  Â  Â  Â  Â  <button class="btn level" data-level="hard">Hard</button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="slider-wrap" aria-live="polite">
Â  Â  Â  Â  Â  <label for="speed" class="sr">Speed (WPM)</label>
Â  Â  Â  Â  Â  <span>Speed:</span>
Â  Â  Â  Â  Â  <input id="speed" type="range" min="50" max="300" value="200" step="10" />
Â  Â  Â  Â  Â  <span class="badge"><span id="wpmVal">200</span> </span>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  Â  <div class="viewport" id="viewport" aria-live="polite" aria-atomic="true">
Â  Â  Â  Â  <div class="placeholder" id="placeholder">
Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  <div style="font-weight:700; font-size:18px; margin-bottom:4px">Ready to practice?</div>
Â  Â  Â  Â  Â  Â  <div>Select a difficulty and press <em>Start</em>.</div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="scroller" id="scroller">
Â  Â  Â  Â  Â  <div class="passage" id="passage"></div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  Â  <div class="controls" id="controls">
Â  Â  Â  Â  <button id="startBtn" class="btn primary">Start</button>
Â  Â  Â  Â  <div id="runControls" class="hidden">
Â  Â  Â  Â  Â  <button id="pauseBtn" class="btn btn-warning">Pause</button>
Â  Â  Â  Â  Â  <button id="resetBtn" class="btn btn-outline">Reset</button>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  Â  <div class="sub" style="margin-top:10px">Tip: You can change the speed while it is still scrolling â€” it adjusts instantly!</div>
Â  Â  </div>
Â  </main>
Â  <script>
Â  Â  // === Passages JSON ===
Â  Â  // Expected structure in passages.json (same folder as index.html):
Â  Â  // {
Â  Â  //Â  "easy":Â  Â ["para 1...", "para 2..."],
Â  Â  //Â  "medium": ["para ..."],
Â  Â  //Â  "hard":Â  Â ["para ..."]
Â  Â  // }
Â  Â  const levels = document.querySelectorAll('.btn.level');
Â  Â  const speedSlider = document.getElementById('speed');
Â  Â  const wpmVal = document.getElementById('wpmVal');
Â  Â  const startBtn = document.getElementById('startBtn');
Â  Â  const pauseBtn = document.getElementById('pauseBtn');
Â  Â  const resetBtn = document.getElementById('resetBtn');
Â  Â  const runControls = document.getElementById('runControls');
Â  Â  const viewport = document.getElementById('viewport');
Â  Â  const scroller = document.getElementById('scroller');
Â  Â  const passageEl = document.getElementById('passage');
Â  Â  const placeholder = document.getElementById('placeholder');
Â  Â  let passages = { easy:[], medium:[], hard:[] };
Â  Â  let currentLevel = null; // Changed from 'easy' to null
Â  Â  let currentText = '';
Â  Â  // Animation state
Â  Â  let rafId = null;
Â  Â  let running = false;
Â  Â  let paused = false;
Â  Â  let y = 0; // current translateY px
Â  Â  let pxPerSec = 0;
Â  Â  let scrollEndY = 0; // goal translateY
Â  Â  let lastTs = 0;
Â  Â  // Load passages.json
Â  Â  fetch('passages.json')
Â  Â  Â  .then(r => {
Â  Â  Â  Â  if(!r.ok) throw new Error('Could not load passages.json');
Â  Â  Â  Â  return r.json();
Â  Â  Â  })
Â  Â  Â  .then(json => {
Â  Â  Â  Â  // Normalize: accept objects with {text: "..."} too
Â  Â  Â  Â  const norm = arr => (arr||[]).map(x => typeof x === 'string' ? x : (x && (x.text||x.passage||x.content)) || '').filter(Boolean);
Â  Â  Â  Â  passages.easy = norm(json.easy);
Â  Â  Â  Â  passages.medium = norm(json.medium);
Â  Â  Â  Â  passages.hard = norm(json.hard);
Â  Â  Â  Â  // Removed automatic call to setLevel('easy')
Â  Â  Â  })
Â  Â  Â  .catch(err => {
Â  Â  Â  Â  placeholder.innerHTML = `<div><strong style="color:#fca5a5">Error:</strong> ${err.message}.<br/>Place a <code>passages.json</code> file next to this <code>index.html</code>.</div>`;
Â  Â  Â  });
Â  Â  // UI Handlers
Â  Â  levels.forEach(btn => btn.addEventListener('click', () => setLevel(btn.dataset.level)));
Â  Â  speedSlider.addEventListener('input', () => {
Â  Â  Â  wpmVal.textContent = speedSlider.value;
Â  Â  Â  if(running && !paused){
Â  Â  Â  Â  // Recompute speed based on new WPM
Â  Â  Â  Â  const wpm = Number(speedSlider.value);
Â  Â  Â  Â  const words = countWords(currentText);
Â  Â  Â  Â  const duration = Math.max(0.5, (words / Math.max(1, wpm)) * 60); // seconds
Â  Â  Â  Â  const distance = (viewport.clientHeight + scroller.offsetHeight);
Â  Â  Â  Â  pxPerSec = distance / duration;
Â  Â  Â  }
Â  Â  });
Â  Â  startBtn.addEventListener('click', startCountdownThenScroll);
Â  Â  pauseBtn.addEventListener('click', () => {
Â  Â  Â  if(!running) return;
Â  Â  Â  paused = !paused;
Â  Â  Â  pauseBtn.textContent = paused ? 'Resume' : 'Pause';
Â  Â  Â  if(!paused){
Â  Â  Â  Â  lastTs = performance.now();
Â  Â  Â  Â  rafId = requestAnimationFrame(tick);
Â  Â  Â  } else {
Â  Â  Â  Â  cancelAnimationFrame(rafId);
Â  Â  Â  }
Â  Â  });
Â  Â  resetBtn.addEventListener('click', resetAll);
Â  Â  function setLevel(level){
Â  Â  Â  if(running) return; // avoid switching mid-run; user can reset first
Â  Â  Â  currentLevel = level;
Â  Â  Â  levels.forEach(b => b.classList.toggle('active', b.dataset.level === level));
Â  Â  Â  // Choose a random passage from the level
Â  Â  Â  const pool = passages[level] || [];
Â  Â  Â  currentText = pool.length ? pool[Math.floor(Math.random()*pool.length)] : '(No passages found for this level.)';
Â  Â  Â  // Show info in placeholder; hide scroller content until Start
Â  Â  Â  passageEl.textContent = '';
Â  Â  Â  scroller.style.transform = 'translateY(0px)';
Â  Â  Â  placeholder.classList.remove('hidden');
Â  Â  Â  placeholder.innerHTML = `<div><div style="font-weight:700; font-size:18px; margin-bottom:6px">${capitalize(level)} selected</div><div>Press <strong>Start</strong> to begin the countdown.<br/>Speed is set to <strong>${speedSlider.value} WPM</strong>.</div></div>`;
Â  Â  }
Â  Â  async function startCountdownThenScroll(){
Â  Â  Â  if(running) return;
      // Added a check to ensure a level is selected
      if(!currentLevel || !passages[currentLevel].length) {
        alert("Please select a difficulty level with available passages before starting.");
        return;
      }
Â  Â  Â  if(!currentText) setLevel(currentLevel);
Â  Â  Â  // Replace Start button with running controls
Â  Â  Â  startBtn.classList.add('hidden');
Â  Â  Â  runControls.classList.remove('hidden');
Â  Â  Â  // Countdown overlay inside viewport
Â  Â  Â  placeholder.classList.remove('hidden');
Â  Â  Â  placeholder.innerHTML = countdownMarkup(3);
Â  Â  Â  await doCountdown(3);
Â  Â  Â  // Prepare text and start scrolling
Â  Â  Â  placeholder.classList.add('hidden');
Â  Â  Â  passageEl.textContent = currentText;
Â  Â  Â  prepareAndStartScroll();
Â  Â  }
Â  Â  function prepareAndStartScroll(){
Â  Â  Â  // Re-enable the pause button
Â  Â  Â  pauseBtn.disabled = false;
Â  Â  Â  // Position scroller just below the viewport
Â  Â  Â  const viewH = viewport.clientHeight;
Â  Â  Â  const contentH = scroller.offsetHeight; // passage already injected
Â  Â  Â  y = viewH; // start just below
Â  Â  Â  scroller.style.transform = `translateY(${y}px)`;
Â  Â  Â  const words = countWords(currentText);
Â  Â  Â  const wpm = Number(speedSlider.value);
Â  Â  Â  const duration = Math.max(0.5, (words / Math.max(1, wpm)) * 60); // in seconds
Â  Â  Â  const distance = viewH + contentH; // total travel
Â  Â  Â  pxPerSec = distance / duration;
Â  Â  Â  scrollEndY = -contentH;
Â  Â  Â  running = true; paused = false; lastTs = performance.now();
Â  Â  Â  rafId = requestAnimationFrame(tick);
Â  Â  }
Â  Â  function tick(ts){
Â  Â  Â  if(paused){ return; }
Â  Â  Â  const dt = (ts - lastTs) / 1000; // seconds
Â  Â  Â  lastTs = ts;
Â  Â  Â  y -= pxPerSec * dt; // move up
Â  Â  Â  if(y <= scrollEndY){
Â  Â  Â  Â  y = scrollEndY;
Â  Â  Â  Â  scroller.style.transform = `translateY(${y}px)`;
Â  Â  Â  Â  finish();
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â  scroller.style.transform = `translateY(${y}px)`;
Â  Â  Â  rafId = requestAnimationFrame(tick);
Â  Â  }
Â  Â  function finish(){
Â  Â  Â  running = false; paused = false;
Â  Â  Â  pauseBtn.textContent = 'Pause';
Â  Â  Â  // Disable the pause button
Â  Â  Â  pauseBtn.disabled = true;
Â  Â  Â  // Keep runControls visible; user can press Reset to start over
Â  Â  }
Â  Â  function resetAll(){
Â  Â  Â  cancelAnimationFrame(rafId);
Â  Â  Â  running = false; paused = false; y = 0; pxPerSec = 0; lastTs = 0;
Â  Â  Â  pauseBtn.textContent = 'Pause';
Â  Â  Â  // Re-enable the pause button
Â  Â  Â  pauseBtn.disabled = false;
Â  Â  Â  runControls.classList.add('hidden');
Â  Â  Â  startBtn.classList.remove('hidden');
Â  Â  Â  // Call setLevel() to select a new passage and update the UI
Â  Â  Â  setLevel(currentLevel);
Â  Â  }
Â  Â  // Helpers
Â  Â  function countWords(t){
Â  Â  Â  return (t.trim().match(/\b\w+\b/g) || []).length;
Â  Â  }
Â  Â  function capitalize(s){ return s.charAt(0).toUpperCase() + s.slice(1); }
Â  Â  function countdownMarkup(n){
Â  Â  Â  return `
Â  Â  Â  Â  <div style="display:grid; gap:8px; place-items:center">
Â  Â  Â  Â  Â  <div id="countNum" style="font-size:64px; font-weight:800">${n}</div>
Â  Â  Â  Â  Â  <div style="opacity:.9">Get Ready to Read...</div>
Â  Â  Â  Â  </div>
Â  Â  Â  `;
Â  Â  }
Â  Â  function doCountdown(n){
Â  Â  Â  return new Promise(resolve => {
Â  Â  Â  Â  let i = n;
Â  Â  Â  Â  const numEl = () => document.getElementById('countNum');
Â  Â  Â  Â  const step = () => {
Â  Â  Â  Â  Â  if(i <= 0){ resolve(); return; }
Â  Â  Â  Â  Â  if(numEl()) numEl().textContent = i;
Â  Â  Â  Â  Â  i--;
Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  if(i === 0 && numEl()) numEl().textContent = 'Go!';
Â  Â  Â  Â  Â  Â  setTimeout(() => i>=0 && step(), 500);
Â  Â  Â  Â  Â  }, 500);
Â  Â  Â  Â  };
Â  Â  Â  Â  step();
Â  Â  Â  });
Â  Â  }
Â  </script>
</body>
</html>
